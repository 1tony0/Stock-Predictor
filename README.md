# Stock-Predictor
This repository contains a Python script designed to predict the movement of the S&P 500 stock index using machine learning. The code starts by importing essential libraries, including `yfinance`, `pandas`, `scikit-learn`, and `matplotlib`. It retrieves historical data for the S&P 500 from Yahoo Finance, processes it to remove unnecessary columns such as dividends and stock splits, and plots the historical closing prices. The script then prepares the data by creating a target variable that indicates whether the stock price will go up or down the next day. This is achieved by shifting the closing prices by one day and comparing them to today's prices. It sets up an initial Random Forest Classifier model with 100 estimators and a minimum samples split of 100. It trains the model on historical data from 1990 onwards while ensuring the last 100 entries are reserved for testing to avoid data leakage. The model is trained using key stock indicators like closing, volume, opening, high, and low prices, excluding the target and shifted columns. After training, the script evaluates the model using precision as a performance metric and visualizes the predictions against actual target values. The script incorporates feature engineering to enhance the model by calculating rolling averages and trend indicators over different time horizons. It introduces new predictors that compare the current closing price to rolling averages and sum the target values over these horizons, aiming to capture market trends. The improved model, with increased estimators and a finer minimum samples split, predicts probabilities of price movements, which are then converted to binary outcomes based on a threshold. The script includes a backtesting function to simulate the model's performance over historical data by training and testing in rolling windows, allowing assessment of its predictive power over different periods. This comprehensive approach ensures the model is rigorously tested and refined, providing valuable insights into stock market prediction. The code was developed by Antonio Souza.
